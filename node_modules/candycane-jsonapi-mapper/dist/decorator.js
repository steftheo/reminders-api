'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = jsonApiMapper;

var _actionHookHelpers = require('candycane/dist/decorators/action-hook-helpers');

var _jsonapiMapper = require('jsonapi-mapper');

var _jsonapiMapper2 = _interopRequireDefault(_jsonapiMapper);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function jsonApiMapper(type) {
  return function (target) {
    (0, _actionHookHelpers.addToTargetAfterHooks)(target, function (data) {
      let url = `${ this.request.protocol }://${ this.request.hostname }`;

      const mapper = new _jsonapiMapper2.default.Bookshelf(url);

      return mapper.map(data, type);
    });
  };
}